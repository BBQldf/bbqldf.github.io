---
layout:     post
title:      IOTSAFE:Enforcing Safety and Security Policy with Real IoT Physical Interaction Discovery
subtitle:   NDSS2021-dingwenbo-Huhongxin-chenglong-Clemon University&University at Buffalo
date:       2021-01-13
author:     bbq
header-img: img/post-bg-hacker.jpg
catalog: true
tags:
    - research
    - IoT
    - attacks
---



>Abstract:提出了一个新颖的动态安全和保安政策执行系统，称为IOTSAFE，它可以在考虑到智能家居平台的上下文特征的情况下，捕捉和管理真实的物理互动。为了识别物联网设备的真实物理交互，我们提出了一种 **运行时物理交互发现方法，** 它采用了静态分析和动态测试技术来识别物联网设备之间的运行时物理交互。此外，IOTSAFE构建了 **时态物理交互的物理模型，** 可以预测即将到来的风险情况并相应地阻止不安全的设备状态。我们在SmartThings平台上实现了一个IOTSAFE的原型。我们的广泛评估表明，在我们的实验环境中，IOTSAFE在130个潜在互动中有效地识别了39个真实的物理互动。IOTSAFE还成功地预测了与 **时间性物理交互有关** 的风险情况，准确率接近96%，并防止了高风险的情况。（其实作为一个防御者，这个魔你还是可以的，但是能不能自动化地去模拟呢？他这里面会收集设备的更多的信息，这显然是目前平台无法提供的信息，比如加湿器放置的位置变化这种？人的移动这种，这是会面临的挑战吧）

# I. INTRODUCTION

- 网络空间互动（Cyberspace interactions）。应用程序通过网络空间中的共同设备或系统事件（例如，开关.开/关或家庭模式）进行互动。例如，一个应用程序在日落后打开了灯，而另一个应用程序在同样的灯打开时解锁了门[11]。这两个应用通过同一设备上的light.on事件进行交互，并在物联网平台的网络空间中共享一个共同的设备属性（即软件变量）。我们使用网络空间交互这个术语来指跨应用程序的交互，其中多个应用程序订阅/操作同一个设备。
- 物理互动（Physical interactions）。物联网的一个独特特征是，应用程序/设备可以对物理环境产生影响。这种物理影响使订阅不同设备的应用程序能够通过共享的物理环境通道（如温度、亮度和湿度）[18]，[7]，而不是通过共同的设备属性进行外部互动。例如，一个加热器控制应用程序打开加热器，当温度传感器检测到温度高于预先定义的阈值时，一个温度控制应用程序打开窗户。在这种情况下，温度通道将加热器和温度传感器连接起来，产生物理交互。

在确定智能家居环境中的真实物理交互的特征方面有几个挑战：

关于第一个挑战，现有的静态方法[10]、[29]、[18]、[14]不能应用于识别真实的物理交互。例如，IoTMon[18]使用应用程序描述的文本挖掘来识别物联网设备之间的共同物理通道，然后发现设备之间所有潜在的物理交互。因此，它不能应用于检测动态物理交互控制中的实时物理交互。事实上，多种因素，如空间位置、设备影响范围和环境条件（spatial location, device influence range, and environment condition——这才是物理交互识别要考虑的，当时只是说很难去模拟，进入到物理事件识别领域后，本身还会面临的难点），都会影响设备的物理交互。例如，如果一个加热器和一个温度传感器被放置在不同的房间，它们之间很可能没有物理交互。另一个主要挑战是考虑物理互动的时间性。物联网设备之间的一些物理交互可能会立即发生，例如，打开一盏灯会立即触发一个照度传感器。相反，存在着缓慢但持续发生的物理互动（时间也是非常重要的问题，当时考虑过）。例如，只有当烤面包机持续运行足够长的时间，它才会引起烟雾警报。然而，要捕捉物联网物理交互的这些上下文特征很重要。在这项工作中，我们提出了IOTSAFE，一个用于多应用物联网环境的动态安全和安保政策执行系统，以预防的方式保护用户免受不安全和不安全的物联网设备互动。我们设计了一种真实的物理交互发现方法，采用静态分析和动态测试技术，有效地捕捉物联网设备之间的真实世界物理交互。 **我们的动态测试的目标是针对物联网环境的空间**** / ****时间效应和设备**** / ****条件限制来测试运行时的物理交互，同时尽量减少整个过程的开销（如时间消耗）。** IOTSAFE还为时空物理交互建立物理模型，以预测未来状态，并在可能发生危险情况时执行安全/安保政策。

# Contributions：

- 我们提出了一种方法来捕捉物联网设备之间的真实物理互动，这在以前的物联网安全方法中是被忽略的。我们的方法采用了静态分析和动态测试技术，考虑到物联网环境的上下文特征， **发现运行时的物理交互，同时也将测试过程的开销降到最低** 。
- 我们的系统根据物理模型预测由时空物理交互引起的风险情况， **向用户生成警告和建议**** (mobile ****的开发**** - ****难**** )**，以防止不安全/不安全的情况发生，从而有效地提高物联网环境的安全和保障。
- 我们在真实世界的智能家居环境中运行的SmartThings平台上评估我们的系统。在一个典型的三室一厅的家庭结构中，我们在130个静态互动中确定了39个真实的物理互动。 **对于动态政策的执行，我们的系统以近**** 96% ****的准确率成功预测了与时间性物理交互有关的风险情况** ，并在给定的36个用户政策下防止了53个高风险的情况。

# II. MOTIVATION &amp; THREAT MODEL

![](RackMultipart20210503-4-1bfkgr9_html_d2880d66a6b33ffa.png)

图1(a)显示了一个智能家居环境中应用间物理交互的例子，攻击者利用机器人吸尘器通过运动通道触发窗户打开。假设智能家居环境中安装了三个应用，一个机器人控制应用、一个窗户控制应用和一个家庭模式控制应用。当一个房间的温度超过85F时，窗户控制应用程序会打开窗户。家庭模式控制应用程序在检测到运动时将家庭模式设置为 &quot;STAY&quot;。在这个例子中，温度提高到85F以上，以触发开窗动作，这可能使家庭处于潜在的不安全状态。为了消除这种潜在的风险，设置了一个安全策略，即 &quot;家中无人时不要打开窗户&quot;（supplement）。执行这一策略可以防止温度传感器在检测到家里没有动静时触发开窗动作。

然而，攻击者可以通过利用机器人真空吸尘器或其控制应用程序来绕过这一安全策略，例如将机器人真空吸尘器设置为在晚上12点工作， **通过意外的物理互动来改变家庭模式，** 机器人真空吸尘器的移动可以被运动传感器检测到。然后，家庭模式控制应用程序将家庭模式改为 &quot;STAY&quot;，虽然家里没人，但可以进行开窗动作。

目前物联网环境中的政策执行系统[11]也忽略了物理互动的连续效应，这可能会错过或延迟政策执行，导致不安全的情况。连续效应意味着一些设备即使在关闭后仍然能够改变环境参数。如图1(b)所示，在一个婴儿房里，当温度低于70F时，一个温度控制应用程序会打开一个加热器。假设用户设置了一个安全策略 &quot;当温度超过82F时关闭加热器&quot;，以防止婴儿房的温度过高。然而，在关闭加热器后，婴儿室仍然可以达到较高的温度，如85F，并保持约半小时（如第V-C节所示）。加热器的持续作用可能导致不安全的情况，并伤害婴儿房里的婴儿。

现有的工作，IoTMon[18]，对应用程序进行静态分析， **以识别潜在的物理交互（它是把一些物理环境通道先模拟出来，然后对**** rules ****进行了静态分析，看看哪些地方可能会涉及到物理交互）** ，而不考虑真实物联网环境中的物联网设备的部署背景信息。因此，IoTMon不能直接应用于检测实时物理交互，以实现运行时策略的执行。此外，识别真实的物理交互需要考虑更复杂的因素，如房间结构、设备影响范围和环境条件。

### 1) Challenges in Identifying Real Physical Interactions:

![](RackMultipart20210503-4-1bfkgr9_html_d114d38e2ff94b02.png)

- Spatial Context：空间环境指的是物联网设备的位置信息。设备之间的交互对位置或房间状态很敏感。例如，在图2（a）中，温度通道使加热器和温度传感器之间发生交互，并可能导致打开窗户的意外行动。然而，加热器和传感器之间的互动高度依赖于它们的位置。如果他们不在同一个房间里，温度传感器不太可能检测到由加热器引起的温度变化。
- Temporal Context：一些设备之间的物理交互可能立即发生，而有些物理交互则是缓慢发生的。例如在图2(b)中，打开一盏灯会立即触发一个照度传感器事件。相反，温度传感器只有在加热器运行足够长的时间后才能观察到温度升高。直观地说，温度、湿度和烟雾等物理通道通常需要时间来明显改变物理状态。（这是更符合实际的假设，iotmon没有考虑到的，并不是说一有物理交互，这个系统就马上出错）
- Implicit Effect：智能家居环境中存在两类隐性效应。一种是一个设备动作可能对其他设备产生多种物理影响。例如，在图2(c)中，恒温器.加热不仅提高了温度，而且还隐含地降低了湿度。另一类隐含效应是由当前静态分析方法[11], [18]无法识别的物理交互作用引起的。因为目前的静态分析方法主要是基于应用描述来发现物理交互，它们只能发现与设备控制应用中明确定义的物理通道相关的物理交互。例如，在图1（b）中，机器人控制应用在其描述中主要解释了机器人吸尘器的清洁功能，但没有提供任何关于其对运动物理通道的潜在影响的描述。（这个时候就需要防御者主动地去建模了）
- Joint Effect：如果有多个设备一起运作，联合的物理影响与单个设备的行为不同。例如，如图2(d)所示，当一个加热器和一个恒温器的加热功能同时进行时，温度迅速升高，触发窗户.打开。（多个设备对于物理通道的作用可能是相互抵消，也可能是相互促进的。）

Physical interactions in a real IoT setting are often contextsensitive, and these contextual factors make capturing real physical interactions non-trivial.

### 2) Challenges in Temporary Physical Interaction Control:

- 设备（如加热器）在被关闭后可能会有持续的影响，这使得即使在执行控制政策后，也可能出现政策违反。
- 时间效应的另一个挑战是由商品物联网传感器的长报告间隔引起的。大多数智能家居传感器具有成本低、电池寿命长的特点，这不可避免地导致报告间隔时间长。例如，关于温度通道，Aeotec MultiSensor 6[4]的报告间隔为10分钟至1小时，Zooz四合一传感器的报告间隔[5]为8分钟至1小时。有了这么长的报告间隔，如果发生了严重的政策违反，系统可能无法及时执行政策。

由于连续效应加上传感器的低报告率，最好能对某些物联网设备的物理效应进行建模和预测，以便在它们做出任何破坏性后果之前及早评估其物理影响。

## B. Threat Model

我们假设意外的物理交互是由恶意的应用程序或在某些限制条件下被破坏的设备引起的，这些限制条件包括。1）攻击者可能没有直接控制敏感应用程序（a window control app）的权限；以及2）敏感设备（锁）可能更强大，不能轻易被攻击者破坏。通过只利用物理互动，攻击者可以通过其他不太敏感的应用程序和容易被破坏的设备间接控制敏感设备。（即攻击者能力有限，敏感设备无法被控制）

我们假设攻击者可以通过以下方式发起攻击：1）脆弱或恶意的物联网应用程序，其中包含脆弱的实现或恶意代码，可以被攻击者轻易利用，以获得远程控制设备的权限；2）脆弱的设备（一个智能插头），其中包含的设计缺陷可以被滥用，以通过意外的物理互动触发周围的设备。

## III. SYSTEM OVERVIEW

![](RackMultipart20210503-4-1bfkgr9_html_6e4705377531a79d.png)

### 1、App Analysis; （静态分析步骤——code analyzer and interaction graph builder）

本模块的目的是分析应用程序中的控制流，以促进IOTSAFE通过动态测试发现物理交互，并在运行时收集应用程序的用户设置/配置（①）。典型应用程序的静态控制流涉及应用程序的触发条件、动作和用户设置。代码分析模块将触发条件和相应的动作提取为 &quot;静态交互&quot;流，并 **生成静态交互图** 。它还根据设备的房间信息（由物联网用户配置）提供粗粒度的 **设备组** 。最后， **静态分析模块在应用部署时收集用户配置并生成细粒度的交互图** 。

作为一个防御者，他可以知道用户对于应用的settings（这样就可以构造出家居图了，需要device ID,room,）和rules

![](RackMultipart20210503-4-1bfkgr9_html_ce025ee51bf3b3ba.png)

Code instrumentation

This app turns on a switch when water is detected by a leakage sensor. In this example, we add extra functions for the data collection in the_**installed()**_function, which collects user setting information and sends them to the server for the interaction graph generation. The _**getdeviceInfo()**_function collects device configuration information and passes it to the _**httpPost()**_function. For the runtime policy enforcement, we instrument additional control logic for the _**waterHandler()**_ function. The instrumented code in the &quot;_**sendRequest()**_function sends the &quot; **switch.on**&quot; action and the related water sensor event to the server and wait for a response. It has a return value, which can be used to receive the response from the policy enforcement server. Only if the server approves the following action, the app resumes executing the switching on commands.

**2) Interaction Graph Generation:**

配置信息需要从每个部署的应用程序中提取 包括 i) 设备ID； ii) 触发条件中的数值（即阈值）；以及 iii) 行动中属性的数值（如冷却温度）。行动中属性的数值（例如，恒温器的冷却温度恒温器的设置）；以及 iv) 房间标签信息。

这个sendRequest函数不需要来自服务器的响应，因为运行时动作执行。IoTSafe将现有的静态交互图划分为多个子图。如果一个设备可以与多个房间的设备进行交互（例如，有多个房间标签的空调），那么我们就把它们添加到每个房间的子图中。如图4所示，实线表示网络空间的交互，虚线是潜在的物理交互。每个节点代表一个设备或一个系统变量。触发条件也被添加到每个路径中，如 &quot;温度\&gt;85F&quot;。最后，静态分析模块输出多个静态交互图，这将用于动态物理交互测试。

![](RackMultipart20210503-4-1bfkgr9_html_919294a602ae3428.png)

### 2、Real Physical Interaction Discovery; （因为有些物理交互存在时间差，需要test cases）（反着测试，先跨房间，然后单房间；先并行，最后顺序测试）

该模块旨在有效地识别给定智能家居设置的真实物理交互。在应用程序部署后，IOTSAFE使用应用程序的配置（例如，触发加热器动作的温度阈值）和房间信息来生成测试案例（②）。基于生成的案例，IOTSAFE通过执行与设备/条件限制有关的动态测试来识别设备物理交互。动态测试包括顺序测试和平行测试（③）。通过全面的顺序测试过程分析空间、隐含和联合效应。引入并行测试是为了减少测试过程的时间消耗。 **IOTSAFE**** 生成了一个有向交互图，其中包括设备状态及其转换。**我们还提供了一种方法来避免测试有风险的设备行为，并使用在线使用数据来识别它们的互动。

Safe &amp; Secure Testing:1）设备限制：一些设备，如锁和洒水器，如果直接测试可能会造成危险的情况。测试过程不得涉及这些敏感设备。2）条件限制：测试过程中的环境条件应在安全范围内。如果某个物理条件超过了安全范围，可能会对家庭财产造成损害，例如，储藏室的高温或潮湿环境。我们的系统需要自适应地安排测试过程，以避免不安全/不安全的条件。

我们的动态测试过程包括两个阶段，测试案例生成和动态测试。测试用例生成模块提供所有基于静态分析结果的可测试用例。在动态测试期间，IOTSAFE以平行方式自动测试设备的行动，并收集传感器的读数。之后，根据这些测试数据计算物理模型的参数。

一个测试用例是一个组中所有设备状态的组合，这些设备在同一个房间，并可能通过物理通道进行交互。房间信息可以在第四章A节的静态分析中从设备的房间标签中获得。假设一个测试组有n个设备，我们定义States(Di)代表设备i（表示为Di）的所有可能的工作模式，例如恒温器的加热、冷却、风扇和关闭。让state(Di)表示Di的工作模式，其中state(Di) ∈ States(Di)。假设一个测试组中有n个设备。一个测试案例是所选设备Di的可能工作模式{D1:off, ... , state(Di), \_ \_ \_ , Dn:off}的组合，其中除Di外的所有其他设备都处于关闭状态。One example testing case is (humidifier.off, AC.off, heater.off, robot.on).

![](RackMultipart20210503-4-1bfkgr9_html_7d91e1019cda9c3c.png)

#### 2) Dynamic Testing:

- ![](RackMultipart20210503-4-1bfkgr9_html_3766fa75a9458273.png)表示与设备Di直接相关的传感器读数，在时间t具有特定的工作模式状态。
- ![](RackMultipart20210503-4-1bfkgr9_html_7971708de66c1027.png)这是Di的当前工作模式状态在时间t2和t1的两个相邻传感器报告间隔之间的传感器读数差。它代表了一个传感器的正常波动。我们用它作为基线来过滤由环境噪音引起的虚假交互。在动态测试中，如果一个设备的传感器读数的差异大于基线波动，我们就识别出一个真实的物理交互。（就是解决传感器本身的误差）

i) sequential testing;

由于连续效应，测试案例的顺序对测试过程的有效性有影响。我们的目标是优化测试案例的顺序，使测试开销Tcost最小。给定一个测试案例，在工作模式下有一个特定的设备Di，tcasei主要受Di的工作时间影响，用twork表示，它与相关传感器的报告间隔有关。

![](RackMultipart20210503-4-1bfkgr9_html_26261a410b69b88a.png)

我们将Di的工作时间记录为twork，将该设备关闭后的闲置时间记录为toff，Dtemp是与时间通道相关的设备集合，如温度、湿度和空气质量。对于与非时间通道相关的设备，twork可以相对较短。然而，为了确保观察到来自传感器的物理效果，我们的系统使twork等于一个传感器报告间隔。在IOTSAFE中，toff被选择为与相关传感器的报告时间间隔相同。根据我们的观察，一个传感器间隔（通常是15分钟）足以识别连续的效果。这里的比较只考虑与特定物理通道有关的触发条件。例如，如果一个加热器的触发条件是 &quot;当时间为18:00&quot;，那么我们的系统就不考虑这个条件。如果一个设备状态与多个触发条件有关，然后系统会对所有的触发条件进行比较。如果有多个案例与当前的家庭环境相匹配，我们的工具会根据贪婪的算法选择与触发条件最接近的案例。

ii) parallel testing

![](RackMultipart20210503-4-1bfkgr9_html_eaa92949599da4b7.png)

**Single-room Parallel Testing**

灯泡的交互通道是照度，加热器的交互通道是温度。因此，在Room1中，灯光和加热器的测试案例可以同时运行（图5中的黄色箭头所示），这减少了动态测试过程的时间开销。

**Cross-room Parallel Testing**

跨房间并行测试用于通过并行化不同房间的顺序测试来减少测试开销。

跨房间设备的测试在图5中显示为粉红色的箭头。对于跨房间的设备，这里的挑战是不同房间的传感器通常不同步地报告事件。因此，我们需要 **一个同步方案来保证从多个传感器收集事件** 。我们引入一个等待时间来保证最长的传感器间隔的覆盖率。我们通过选择一个适当的开始时间、结束时间来解决同步问题，这导致了一个额外的等待时间（在图5中显示为绿色箭头）。以图5为例，Room1有两个传感器，Room2有一个传感器，其中传感器1和传感器2的传感器报告间隔比传感器3长。在传感器校准过程中，IOTSAFE首先获得传感器的报告时间（例如，图5中的s1、s2和s3）。在运行测试过程中，每个案例需要在每个房间至少持续一个传感器报告间隔（即获得两个相邻的报告），这是以多个传感器的最长报告间隔为基础的，即传感器1的间隔加上传感器2的间隔。因此，&quot;AC.heating &quot;的粉色箭头涵盖了传感器1和传感器2的一个间隔，它也涵盖了房间2中传感器3的多个间隔。对于由时间通道交互的情况，也有绿色箭头代表设备关闭后的等待时间Toff。一个跨房间测试结束后，系统等待Toff，然后开始下一个测试案例。系统记录两个报告之间的差异，以建立这个设备的物理影响模型。 **在完成跨房间的测试案例后，系统开始进行单房间的测试案例。**

### 3、Runtime Prediction;

该模块初始化和维护物理模型，以描述物理交互的时间效应。它还监测来自数据采集器的运行时事件， **并将当前状态与物理交互模型进行比较，以预测未来状态（④）** 。在动态测试过程中，IOTSAFE记录相关传感器的时间交互数据。因此，建模过程首先根据测试阶段收集的数据初始化物理模型。对于未测试的设备和新添加的设备，IOTSAFE使用online usage data来训练其交互图和物理模型。如果用户修改了应用程序的设置，IOTSAFE也会根据 **新的位置、触发条件或动作更新交互图** 。在正常使用期间，当收到更多的设备数据时，IOTSAFE继续更新物理模型。

**the offline physical channel modeling**

![](RackMultipart20210503-4-1bfkgr9_html_7196d347f1c92d3.png)

![](RackMultipart20210503-4-1bfkgr9_html_9b474e0dcffce22c.png)从时间t1到t2，具有工作模式状态的Di的通道数量变化量。

![](RackMultipart20210503-4-1bfkgr9_html_9acb4b70a53ea765.png)是多个空气相关参数的乘积，如密度、房间容积、热量或水容量等。以湿度通道为例，模型需要计算空气中水蒸气量的变化。我们通过计算相关设备（如加湿器）提供的水蒸气，并通过空气的比湿容量（水蒸气压力）和温度来计算 ![](RackMultipart20210503-4-1bfkgr9_html_9acb4b70a53ea765.png)，从而建立湿度差。

- **以温度相关的设备为例：**

![](RackMultipart20210503-4-1bfkgr9_html_cb6fe7be6bc7b841.png)

其中Pi可以通过与温度有关的设备Di的影响来计算，或者通过其 **默认功率** 来知道。我们可以从一个设备的功率读数或连接的智能插头的功率表中得到它。对于温度通道，我们确定房间的温度是相当均匀的。而湿度通道对特定的湿度设备距离有一个距离系数，详见附录D。我们使用动态测试过程中收集的数据，为每个设备生成离线物理模型，并估计设备和传感器之间的距离系数。

- **离线数据建模：**

服务器存储所有设备的状态报告和传感器的读数。例如，一个事件 &quot;上午10点打开加热器，温度在20分钟内从70F变为73F &quot;可以用 a string of &quot;Heater (on, 10:00), TemperatureSensor (70F, 10:00), (73F, 10:20)&quot;.

![](RackMultipart20210503-4-1bfkgr9_html_b5a4edf1914026ae.png)

**the runtime policy violation prediction for proactively alerting dangerous physical conditions.**

### 4、Policy Specification and Enforcement.

政策执行机制使用一个控制服务器，该服务器负责通过对照一组用户定义的政策检查应用程序的事件和行动来识别违反政策的行为（也是预定了安全政策）。IOTSAFE 首先要求用户通过政策管理应用程序设置其政策，该应用程序可以基于给定的政策模板，也可以编写自己的政策（⑤）。数据收集组件/应用程序从设备收集运行时信息，并将数据发送到运行时预测和违规检测模块。违规检测是基于将当前/预测的情况与用户定义的策略进行比较（⑥）。如果违规行为即将发生或在一段时间内发生，政策执行组件就会采取行动，以缓解危险情况，例如，发送警告或关闭相关加热器，以避免高温情况（⑦）。 **（这一步就是缓解过程）**

- **Policy Definition:**

它支持时间性和非时间性（即时）的交互控制。我们在图7中说明了我们政策语言的语法。用户可以细化现有的政策模板或使用这种政策语言定义新的政策。表达式（E）可以通过设备ID（d）、设备状态（s）和价值（v）形成。该表达式是一个设备状态的列表。多个表达式也可以组成在一起（EoE），被策略用来将多个行动结合在一起。违规检测器收集表达式状态，并将其作为谓词。强制执行的行动包含设备ID（d）、设备行动（a）或策略行动。设备ID是目标设备ID的字符串。设备动作是设备需要执行的命令（例如，开/关）。策略动作包含批准/拒绝应用程序的请求，以及执行一个动作（例如，在高温警报期间关闭加热器，或向用户发送警告）。

![](RackMultipart20210503-4-1bfkgr9_html_23b17b8e17b2e121.png)

![](RackMultipart20210503-4-1bfkgr9_html_3cc41a47fae73602.png)

策略是 &quot;当温度高于85F时关闭加热器并发出警告&quot;。IOTSAFE使用温度物理模型来获得预测的温度值。如果预测的温度高于85F，政策执行模块将触发该政策和heat.off动作，即使传感器没有报告违规的读数。根据语法，触发条件表达式包含三个元素，设备ID是 &quot;sensor1&quot;，状态是 &quot;value&quot;，触发条件值是 &quot;85&quot;。条件是 &quot;device id == sensor1 &quot;和 &quot;sensor1.value \&gt; 85&quot;。它包含两个 &quot;implement() &quot;动作，即 &quot;heater.off &quot;和 &quot;push（温度警告）&quot;。如果没有预测到违规，系统不执行任何行动，只是跳过政策并记录这个温度报告。

- **动态策略的执行是通过两个方面实现的**

该系统在一个应用程序的所有命令前设置了一个 &quot;如果 &quot;条件和一个 &quot;http请求&quot;。如果服务器在当前环境下批准了这种行动，服务器将向应用程序发送一个 &quot;批准 &quot;消息。否则，这个动作将被拒绝。（第一个是触发条件增强。它从交互图中搜索所有相关设备，这些设备可以触发这个政策。）

第二个执行方案以预测的政策执行为目标。IOTSAFE使用一个监控应用程序将所有设备的事件发送到服务器并等待响应。它使用 &quot;http请求 &quot;来定期（例如每分钟）询问执行行动，这确保了对任何预测的违规行为的及时执行。（如果系统检测到多个可以与同一物理通道互动的设备，如加热器和AC.heating，系统会要求用户对其他设备的行动执行策略。在图1（b）的情况下，如果多个加热设备在工作，系统不仅会执行 &quot;加热器.关闭&quot;，还会询问用户是否需要关闭其他加热设备。）

![](RackMultipart20210503-4-1bfkgr9_html_f44c94dd2b9ba554.png)

# V. IMPLEMENTATION AND EVALUATION

我们在三星SmartThings平台[21]的基础上实现了IOTSAFE的概念验证原型系统。我们在网络空间和物理交互方面共研究了45个官方SmartThings应用[17]，以证明IOTSAFE的有效性。选择了21个有代表性的物联网应用（基于它们的功能和用户研究[16]，[28]），并在谷歌云平台[24]上运行的Web服务器的基础上设置了策略执行服务器。

## A. Smart Home Testbed Setting

![](RackMultipart20210503-4-1bfkgr9_html_8280cb10697d1f99.png)

我们将我们的结果与IoTMon[18]进行了比较，后者基于静态分析得出了潜在的物理交互。IoTMon通过拼接应用程序发现所有潜在的物理交互，如果它们共享共同的物理通道。真正的物理交互是由IOTSAFE通过静态分析和动态测试确定的。表一列出了物理交互的发现结果。它还报告了静态分析方法的假阴性（FN）和假阳性（FP）结果[18]。隐性交互实际上是静态分析的假阴性，这是动态测试发现的交互，但被静态分析忽略了。假阳性结果是由静态分析的局限性造成的，如错误的交互分析、缺少房间布局和设备距离。

![](RackMultipart20210503-4-1bfkgr9_html_f2d8531e4a229150.png)

## C. Runtime Prediction（就是误差的测量，导致了普适性的问题）

我们测量了我们的建模方法对时间性通道的有效性，我们主要关注与温度有关的设备。

## D. Case Studies（是的，典型的case能成功，但是这种设定是具有针对性的，是否能完全应用在陌生环境呢？）

![](RackMultipart20210503-4-1bfkgr9_html_89ce09347d5ba993.png)

- Case1：在图11中，攻击者利用两个被破坏的物联网设备来打开窗户。攻击者首先操纵扫地机器人触发 &quot;STAY &quot;家庭模式（即有人在家），以绕过安全策略 &quot;无人在家时不要打开窗户&quot;。然后他/她操纵一个加热器来提高温度，以触发开窗动作。IOTSAFE首先检测了机器人和运动传感器之间的互动。然后，我们的系统向用户提供提示，以设置额外的触发条件。例如，如果用户设置一个额外的条件为 &quot;当机器人工作时不要触发家庭模式&quot;，家庭模式应用程序将被策略阻止。如图11中的红叉所示，我们的系统可以阻止对家庭模式的恶意操作。
- Case2：为了证明基于物理建模的风险条件预测的有效性，比较基于表九中第7组的智能家居设置的两种执行方案的结果。引入了一个恶意的加热器控制应用程序，使加热器一直处于开启状态。我们首先测试了一连串的加热器/空调.加热案例，没有基于物理模型的预测。假设用户设置的策略是 &quot;温度高于80F时，关闭所有加热设备。&quot;和 &quot;当温度高于84F时打开窗户&quot;。如图10(a)所示，在没有预测的情况下，政策的执行被推迟了11分钟左右，温度达到82.4F。即使在关闭加热设备后，温度仍然达到84F，高温可以保持5个报告间隔（75分钟）。在图10(b)中，我们用基于物理模型的预测测试了同一序列。IOTSAFE提前18分钟关闭了加热器，家庭环境被保持在高温情况下。

# Conclusion

**Physical Interaction Discovery:** 基于静态分析的物理交互的识别存在高估问题（即高误报）。我们指出，有必要通过动态分析（例如，动态测试）来发现真正的物理交互。就我们所知，这是第一个关于物联网中基于动态测试的物理交互发现的研究。物联网设备之间的物理交互受制于智能家居环境的空间和时间背景，例如物联网设备的部署位置，甚至是外部环境。在这项工作中，我们不考虑外部环境和时间动态对物理交互的影响（例如，时间和季节性影响）。我们将通过考虑外部环境的影响和时间动态来增强我们的方法，这将是我们未来的工作。

**Dynamic Testing Safety and Optimization:** 识别物理交互的动态测试与传统软件测试[12]的一个明显特征是，我们的动态测试过程对智能家居环境有物理影响（如温度变化）。改变物理环境可能导致风险情况，并在测试过程中引起安全问题。因此，设备的某些功能不能被测试或只能在有限的范围内测试，这可能会错过一些物理交互（例如，烤面包机到烟雾通道）。另一个挑战是测试开销，这与探索/测试可能路径的排序有关。作为我们未来工作的一部分，我们将把这个问题表述为一个优化问题，以最大限度地减少测试开销并确保测试安全。

**Human Interaction:** IOTSAFE主要考虑设备之间的交互，不考虑用户在环境中的直接交互。IOTSAFE的一个限制是它需要一个动态的测试期，这可能会受到人类活动的干扰。而人类活动（如行走、打开设备）可能会在动态测试期间造成假阳性的交互结果。预测也没有考虑人类活动的物理影响。在我们未来的工作中，我们计划解决这个挑战，即如何识别和预测人类活动的影响。

**Applicability and Generality:** 尽管我们在SmartThings平台上实例化了IOTSAFE，但我们的设计可以潜在地应用于其他物联网平台，如Open- HAB[31]平台。动态测试过程是平台无关的，因此它可以在不同的物联网平台上工作。IOTSAFE需要一个真实世界的物理交互发现阶段，这需要时间并产生一定的开销。此外，政策执行的任何假阳性（例如，一个良性动作被错误地阻止）可能会损害可用性。在未来的工作中，我们计划进行用户研究，以评估IOTSAFE的动态测试过程和政策执行的可用性。


